import{d as e,r as t,c as l,o as s,a,b as i,e as n,t as r,u as o,f as c,w as d,v as u,F as g,g as m,h as p,n as f,i as b,j as v,k as x,l as y,m as h,p as k,q as w}from"./pinia-CjnXQTyf.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const _=e("listings",()=>{const e=t([]),s=t(null),a=t({min:0,max:1e4}),i=t([]),n=t(0),r=t({from:null,to:null}),o=l(()=>[...new Set(e.value.map(e=>e.city))].sort()),c=l(()=>[...new Set(e.value.map(e=>e.site))]),d=l(()=>e.value.filter(e=>{if(s.value&&e.city!==s.value)return!1;if(e.price<a.value.min||e.price>a.value.max)return!1;if(i.value.length&&!i.value.includes(e.site))return!1;if(e.surface<n.value)return!1;if(r.value.from||r.value.to){const t=new Date(e.published_at);if(r.value.from&&t<new Date(r.value.from))return!1;if(r.value.to&&t>new Date(r.value.to))return!1}return!0})),u=l(()=>{let e=0;return s.value&&e++,(a.value.min>0||a.value.max<1e4)&&e++,i.value.length&&e++,n.value>0&&e++,(r.value.from||r.value.to)&&e++,e});return{allListings:e,selectedCity:s,priceRange:a,selectedSites:i,surfaceMin:n,dateRange:r,uniqueCities:o,uniqueSites:c,appliedFilters:d,filterCount:u,loadListings:t=>{e.value=t},setSelectedCity:e=>{s.value=e},setPriceRange:(e,t)=>{a.value={min:e,max:t}},toggleSite:e=>{const t=i.value.indexOf(e);t>-1?i.value.splice(t,1):i.value.push(e)},setSites:e=>{i.value=[...e]},setSurfaceMin:e=>{n.value=e},setDateRange:(e,t)=>{r.value={from:e,to:t}},resetFilters:()=>{s.value=null,a.value={min:0,max:1e4},i.value=[],n.value=0,r.value={from:null,to:null}},getListingById:t=>e.value.find(e=>e.listing_id===t)}}),S=e("stats",()=>{const e=t({}),s=t({}),a=t({}),i={"Athome.lu":"#9966FF","Nextimmo.lu":"#FF9F40","VIVI.lu":"#FFCE56","SothebysRealty.lu":"#FF6384","Newimmo.lu":"#36A2EB","Immotop.lu":"#4BC0C0","Floor.lu":"#2ECC71"},n=[{label:"< 1500â‚¬",min:0,max:1500,color:"#10B981"},{label:"1500â‚¬ - 2000â‚¬",min:1500,max:2e3,color:"#3B82F6"},{label:"2000â‚¬ - 2500â‚¬",min:2e3,max:2500,color:"#F59E0B"},{label:"> 2500â‚¬",min:2500,max:1/0,color:"#EF4444"}],r=l(()=>Object.values(s.value).filter(e=>"HIGH"===e).length),o=l(()=>Object.values(s.value).filter(e=>"GOOD_DEAL"===e).length),c=l(()=>Object.entries(a.value).sort(([,e],[,t])=>t.count-e.count).slice(0,10).map(([e,t])=>({city:e,...t})));return{globalStats:e,anomalies:s,marketStats:a,SITE_COLORS:i,PRICE_RANGES:n,highAnomaliesCount:r,goodDealsCount:o,topCities:c,loadStats:t=>{e.value=t},loadAnomalies:e=>{s.value=e},loadMarketStats:e=>{a.value=e},getCityStats:e=>a.value[e]||{},getSiteColor:e=>i[e]||"#6B7280",getSiteCount:(e,t)=>t.filter(t=>t.site===e).length,getPriceRangeColor:e=>{for(const t of n)if(e>=t.min&&e<t.max)return t.color;return"#6B7280"}}});function C(e){return`https://zaalouni.github.io/immo-bot-luxembourg/dashboards2/data/${e}`}async function A(){const e=await fetch(C("listings.json"));if(!e.ok)throw new Error("Failed to load listings");return e.json()}async function F(){try{const e=await fetch(C("stats.js")),t=(await e.text()).match(/const\s+STATS\s*=\s*({[\s\S]*?});/);if(!t)throw new Error("STATS not found in stats.js");return JSON.parse(t[1])}catch(e){return{}}}async function P(){try{const e=await fetch(C("anomalies.js")),t=(await e.text()).match(/const\s+ANOMALIES\s*=\s*({[\s\S]*?});/);if(!t)throw new Error("ANOMALIES not found in anomalies.js");return JSON.parse(t[1])}catch(e){return{}}}async function E(){try{const e=await fetch(C("market-stats.js")),t=(await e.text()).match(/const\s+MARKET_STATS\s*=\s*({[\s\S]*?});/);if(!t)throw new Error("MARKET_STATS not found in market-stats.js");return JSON.parse(t[1])}catch(e){return{}}}function L(e){return null==e?"â€”":new Intl.NumberFormat("fr-LU",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function M(e,t=0){return null==e?"â€”":new Intl.NumberFormat("fr-LU",{minimumFractionDigits:t,maximumFractionDigits:t}).format(e)}function D(e,t=50){return e?e.length<=t?e:e.substring(0,t)+"...":"â€”"}const j=(e,t)=>{const l=e.__vccOpts||e;for(const[s,a]of t)l[s]=a;return l},O={class:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40"},R={class:"container mx-auto px-4 py-4"},V={class:"flex items-center justify-between mb-4"},I={class:"text-right"},T={class:"text-sm text-gray-600"},q={class:"grid grid-cols-2 md:grid-cols-5 gap-3"},N={class:"stat-card animate-fade-in"},B={class:"stat-value"},U={class:"stat-card animate-fade-in",style:{"animation-delay":"0.1s"}},$={class:"stat-value"},G={class:"stat-card animate-fade-in",style:{"animation-delay":"0.2s"}},H={class:"stat-value"},z={class:"stat-card animate-fade-in",style:{"animation-delay":"0.3s"}},J={class:"stat-value"},K={class:"stat-card animate-fade-in",style:{"animation-delay":"0.4s"}},W={class:"stat-value text-warning"},Z={class:"text-danger"},Q=j({__name:"Header",setup(e){const t=_(),c=S(),d=l(()=>(new Date).toLocaleString("fr-LU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}));return(e,l)=>(s(),a("header",O,[i("div",R,[i("div",V,[l[1]||(l[1]=i("div",null,[i("h1",{class:"text-3xl font-bold text-primary"},"ðŸ  ImmoLux Dashboard2"),i("p",{class:"text-sm text-gray-600"},"Annonces immobiliÃ¨res Ã  Luxembourg")],-1)),i("div",I,[i("p",T,[l[0]||(l[0]=i("i",{class:"fas fa-sync"},null,-1)),n(" Mis Ã  jour: "+r(d.value),1)])])]),i("div",q,[i("div",N,[i("div",B,r(o(c).globalStats.total||0),1),l[2]||(l[2]=i("div",{class:"stat-label"},"Annonces",-1))]),i("div",U,[i("div",$,r(o(L)(o(c).globalStats.avg_price)),1),l[3]||(l[3]=i("div",{class:"stat-label"},"Prix moy.",-1))]),i("div",G,[i("div",H,r(o(t).uniqueCities.length),1),l[4]||(l[4]=i("div",{class:"stat-label"},"Villes",-1))]),i("div",z,[i("div",J,r(o(c).globalStats.avg_surface||0)+"mÂ²",1),l[5]||(l[5]=i("div",{class:"stat-label"},"Surface moy.",-1))]),i("div",K,[i("div",W,[n(r(o(c).highAnomaliesCount)+" ",1),i("span",Z,r(o(c).goodDealsCount),1)]),l[6]||(l[6]=i("div",{class:"stat-label"},"ðŸš¨ / ðŸŽ‰",-1))])])])]))}},[["__scopeId","data-v-1a3cbb96"]]),X={class:"bg-white rounded-lg shadow-sm p-6 mb-6 border border-gray-200"},Y={class:"text-lg font-semibold text-gray-800 mb-4"},ee={key:0,class:"badge bg-primary text-white ml-2"},te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4"},le={class:"filter-group"},se={value:""},ae=["value"],ie={class:"filter-group"},ne={class:"filter-group"},re={class:"filter-group"},oe={class:"filter-group"},ce=["value"],de={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ue={class:"filter-group"},ge={class:"filter-group"},me={class:"flex gap-3"},pe={class:"flex-1 text-sm text-gray-600 self-center"},fe=j({__name:"Filters",setup(e){const t=_(),l=()=>{t.resetFilters()};return(e,f)=>(s(),a("div",X,[i("h2",Y,[f[7]||(f[7]=i("i",{class:"fas fa-filter"},null,-1)),f[8]||(f[8]=n(" Filtres ",-1)),o(t).filterCount>0?(s(),a("span",ee,r(o(t).filterCount)+" actif"+r(o(t).filterCount>1?"s":""),1)):c("",!0)]),i("div",te,[i("div",le,[f[9]||(f[9]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ville",-1)),d(i("select",{"onUpdate:modelValue":f[0]||(f[0]=e=>o(t).selectedCity=e),class:"input-field"},[i("option",se,"Toutes les villes ("+r(o(t).uniqueCities.length)+")",1),(s(!0),a(g,null,m(o(t).uniqueCities,e=>(s(),a("option",{key:e,value:e},r(e),9,ae))),128))],512),[[u,o(t).selectedCity]])]),i("div",ie,[f[10]||(f[10]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix min (â‚¬)",-1)),d(i("input",{"onUpdate:modelValue":f[1]||(f[1]=e=>o(t).priceRange.min=e),type:"number",class:"input-field",placeholder:"0"},null,512),[[p,o(t).priceRange.min,void 0,{number:!0}]])]),i("div",ne,[f[11]||(f[11]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix max (â‚¬)",-1)),d(i("input",{"onUpdate:modelValue":f[2]||(f[2]=e=>o(t).priceRange.max=e),type:"number",class:"input-field",placeholder:"10000"},null,512),[[p,o(t).priceRange.max,void 0,{number:!0}]])]),i("div",re,[f[12]||(f[12]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Surface min (mÂ²)",-1)),d(i("input",{"onUpdate:modelValue":f[3]||(f[3]=e=>o(t).surfaceMin=e),type:"number",class:"input-field",placeholder:"0"},null,512),[[p,o(t).surfaceMin,void 0,{number:!0}]])]),i("div",oe,[f[13]||(f[13]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Sites",-1)),d(i("select",{"onUpdate:modelValue":f[4]||(f[4]=e=>o(t).selectedSites=e),multiple:"",class:"input-field",size:"3"},[(s(!0),a(g,null,m(o(t).uniqueSites,e=>(s(),a("option",{key:e,value:e},r(e),9,ce))),128))],512),[[u,o(t).selectedSites]]),f[14]||(f[14]=i("small",{class:"text-gray-500"},"Ctrl+Click pour multi-sÃ©lection",-1))])]),i("div",de,[i("div",ue,[f[15]||(f[15]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de publication (de)",-1)),d(i("input",{"onUpdate:modelValue":f[5]||(f[5]=e=>o(t).dateRange.from=e),type:"date",class:"input-field"},null,512),[[p,o(t).dateRange.from]])]),i("div",ge,[f[16]||(f[16]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de publication (Ã )",-1)),d(i("input",{"onUpdate:modelValue":f[6]||(f[6]=e=>o(t).dateRange.to=e),type:"date",class:"input-field"},null,512),[[p,o(t).dateRange.to]])])]),i("div",me,[i("button",{onClick:l,class:"btn btn-secondary"},[...f[17]||(f[17]=[i("i",{class:"fas fa-redo"},null,-1),n(" RÃ©initialiser ",-1)])]),i("p",pe,[f[18]||(f[18]=i("i",{class:"fas fa-list"},null,-1)),n(" "+r(o(t).appliedFilters.length)+" annonce(s) trouvÃ©e(s) ",1)])])]))}},[["__scopeId","data-v-f8e8eb2b"]]);const be={key:0,class:"badge bg-danger text-white"},ve={key:1,class:"badge bg-success text-white"},xe={key:2,class:"text-gray-400 text-xs"},ye=j({__name:"AnomalyBadge",props:{flag:{type:String,default:null}},setup:e=>(t,l)=>"HIGH"===e.flag?(s(),a("span",be,"ðŸš¨ CHER")):"GOOD_DEAL"===e.flag?(s(),a("span",ve,"ðŸŽ‰ AFFAIRE")):(s(),a("span",xe,"â€”"))},[["__scopeId","data-v-300ebdf7"]]),he={class:"card overflow-x-auto"},ke={class:"table-header"},we={class:"font-medium"},_e={class:"font-bold text-primary"},Se={class:"text-sm text-gray-600"},Ce=["href"],Ae={key:0,class:"text-center py-8 text-gray-500"},Fe={__name:"TableView",setup(e){const n=_(),d=S(),u=t("time_ago"),p=t(!1),v=l(()=>function(e,t,l=!0){const s=[...e];return s.sort((e,s)=>{let a=e[t],i=s[t];return"string"==typeof a?(a=a.toLowerCase(),i=i.toLowerCase(),l?a.localeCompare(i):i.localeCompare(a)):l?a-i:i-a}),s}(n.appliedFilters,u.value,p.value)),x=e=>{u.value===e?p.value=!p.value:(u.value=e,p.value=!0)},y=e=>u.value!==e?"â–¼":p.value?"â–²":"â–¼";return(e,t)=>(s(),a("div",he,[i("table",null,[i("thead",ke,[i("tr",null,[i("th",{onClick:t[0]||(t[0]=e=>x("site")),class:"cursor-pointer"}," Site "+r(y("site")),1),i("th",{onClick:t[1]||(t[1]=e=>x("city")),class:"cursor-pointer"}," Ville "+r(y("city")),1),i("th",{onClick:t[2]||(t[2]=e=>x("price")),class:"cursor-pointer"}," Prix "+r(y("price")),1),i("th",{onClick:t[3]||(t[3]=e=>x("rooms")),class:"cursor-pointer"}," PiÃ¨ces "+r(y("rooms")),1),i("th",{onClick:t[4]||(t[4]=e=>x("surface")),class:"cursor-pointer"}," Surface "+r(y("surface")),1),i("th",{onClick:t[5]||(t[5]=e=>x("price_m2")),class:"cursor-pointer"}," â‚¬/mÂ² "+r(y("price_m2")),1),i("th",{onClick:t[6]||(t[6]=e=>x("time_ago")),class:"cursor-pointer"}," Temps "+r(y("time_ago")),1),t[7]||(t[7]=i("th",null,"Anomalie",-1)),t[8]||(t[8]=i("th",null,"Titre",-1))])]),i("tbody",null,[(s(!0),a(g,null,m(v.value,e=>(s(),a("tr",{key:e.listing_id},[i("td",null,[i("span",{class:"site-badge",style:f({backgroundColor:o(d).getSiteColor(e.site)})},r(e.site.split(".")[0]),5)]),i("td",we,r(e.city),1),i("td",_e,r(o(L)(e.price)),1),i("td",null,r(e.rooms||"â€”"),1),i("td",null,r(e.surface)+"mÂ²",1),i("td",null,r(o(M)(e.price_m2,0))+"â‚¬",1),i("td",Se,r(e.time_ago),1),i("td",null,[b(ye,{flag:e.price_anomaly},null,8,["flag"])]),i("td",null,[i("a",{href:e.url,target:"_blank",class:"text-blue-600 hover:underline text-sm"},r(o(D)(e.title,40)),9,Ce)])]))),128))])]),0===v.value.length?(s(),a("div",Ae,[...t[9]||(t[9]=[i("i",{class:"fas fa-inbox text-2xl mb-2"},null,-1),i("p",null,"Aucune annonce ne correspond Ã  vos filtres",-1)])])):c("",!0)]))}},Pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ee={class:"flex items-start justify-between mb-3"},Le={class:"text-lg font-semibold text-gray-800"},Me=["onClick"],De={class:"grid grid-cols-2 gap-2 mb-3 text-sm"},je={class:"font-bold text-primary"},Oe={class:"font-bold"},Re={class:"font-bold"},Ve={class:"font-bold"},Ie={class:"border-t border-gray-200 pt-3"},Te={class:"space-y-2"},qe=["href"],Ne={key:0,class:"col-span-full text-center py-8 text-gray-500"},Be={__name:"CityView",setup(e){const t=_(),l=e=>t.appliedFilters.filter(t=>t.city===e),n=e=>l(e).length,d=e=>{const t=l(e);return 0===t.length?0:Math.round(t.reduce((e,t)=>e+t.price,0)/t.length)},u=e=>{const t=l(e);if(0===t.length)return 0;const s=t.map(e=>e.price).sort((e,t)=>e-t),a=Math.floor(s.length/2);return s.length%2!=0?s[a]:(s[a-1]+s[a])/2},p=e=>{const t=l(e);if(0===t.length)return 0;const s=t.filter(e=>e.surface>0).map(e=>e.surface);return 0===s.length?0:Math.round(s.reduce((e,t)=>e+t,0)/s.length)},f=(e,t)=>l(e).sort((e,t)=>new Date(t.published_at)-new Date(e.published_at)).slice(0,t);return(e,l)=>(s(),a("div",Pe,[(s(!0),a(g,null,m(o(t).uniqueCities,e=>(s(),a("div",{key:e,class:"card"},[i("div",Ee,[i("h3",Le,r(e),1),i("button",{onClick:l=>o(t).setSelectedCity(e),class:"btn btn-primary text-xs py-1 px-2"}," Filtrer ",8,Me)]),i("div",De,[i("div",null,[l[0]||(l[0]=i("span",{class:"text-gray-600"},"Annonces:",-1)),i("p",je,r(n(e)),1)]),i("div",null,[l[1]||(l[1]=i("span",{class:"text-gray-600"},"Prix moy:",-1)),i("p",Oe,r(o(L)(d(e))),1)]),i("div",null,[l[2]||(l[2]=i("span",{class:"text-gray-600"},"MÃ©diane:",-1)),i("p",Re,r(o(L)(u(e))),1)]),i("div",null,[l[3]||(l[3]=i("span",{class:"text-gray-600"},"Surface moy:",-1)),i("p",Ve,r(p(e))+"mÂ²",1)])]),i("div",Ie,[l[4]||(l[4]=i("p",{class:"text-xs font-semibold text-gray-600 mb-2"},"DerniÃ¨res annonces",-1)),i("div",Te,[(s(!0),a(g,null,m(f(e,3),e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"block text-xs text-blue-600 hover:underline truncate"},r(o(L)(e.price))+" - "+r(o(D)(e.title,35)),9,qe))),128))])])]))),128)),0===o(t).uniqueCities.length?(s(),a("div",Ne,[...l[5]||(l[5]=[i("i",{class:"fas fa-inbox text-2xl mb-2"},null,-1),i("p",null,"Aucune ville ne correspond Ã  vos filtres",-1)])])):c("",!0)]))}},Ue={class:"space-y-6"},$e={class:"text-sm font-normal text-gray-600"},Ge={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},He=["href"],ze={class:"flex justify-between items-start mb-2"},Je={class:"font-bold text-primary"},Ke={class:"text-sm font-medium text-gray-800"},We={class:"text-xs text-gray-600"},Ze={class:"text-xs text-gray-500 mt-2"},Qe=["onClick"],Xe={key:1,class:"mt-4 pt-4 border-t border-gray-200"},Ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},et=["href"],tt={class:"flex justify-between items-start mb-2"},lt={class:"font-bold text-primary"},st={class:"text-sm font-medium text-gray-800"},at={class:"text-xs text-gray-600"},it={class:"text-xs text-gray-500 mt-2"},nt=["onClick"],rt={key:0,class:"card text-center py-8 text-gray-500"},ot={__name:"PriceView",setup(e){const u=_();S();const p=t(new Set),x=l(()=>function(e){const t={"< 1500â‚¬":{min:0,max:1500,listings:[]},"1500â‚¬ - 2000â‚¬":{min:1500,max:2e3,listings:[]},"2000â‚¬ - 2500â‚¬":{min:2e3,max:2500,listings:[]},"> 2500â‚¬":{min:2500,max:1/0,listings:[]}};return e.forEach(e=>{for(const[l,s]of Object.entries(t))if(e.price>=s.min&&e.price<s.max){s.listings.push(e);break}}),t}(u.appliedFilters)),y=l(()=>u.appliedFilters.length);return(e,t)=>(s(),a("div",Ue,[(s(!0),a(g,null,m(x.value,(e,t)=>(s(),a("div",{key:t,class:"card",style:f({borderLeft:`4px solid ${e.color}`})},[i("h3",{class:"text-lg font-semibold mb-3",style:f({color:e.color})},[n(r(t)+" ",1),i("span",$e,"("+r(e.listings.length)+" annonces)",1)],4),i("div",Ge,[(s(!0),a(g,null,m(e.listings.slice(0,6),e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow"},[i("div",ze,[i("span",Je,r(o(L)(e.price)),1),b(ye,{flag:e.price_anomaly},null,8,["flag"])]),i("p",Ke,r(e.city),1),i("p",We,r(e.surface)+"mÂ² - "+r(o(M)(e.price_m2,0))+"â‚¬/mÂ²",1),i("p",Ze,r(o(D)(e.title,50)),1)],8,He))),128))]),e.listings.length>6?d((s(),a("button",{key:0,onClick:e=>p.value.add(t),class:"btn btn-secondary text-sm mt-3 w-full"}," Voir "+r(e.listings.length-6)+" autres ("+r(e.listings.length)+" total) ",9,Qe)),[[v,!p.value.has(t)]]):c("",!0),p.value.has(t)?(s(),a("div",Xe,[i("div",Ye,[(s(!0),a(g,null,m(e.listings.slice(6),e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow"},[i("div",tt,[i("span",lt,r(o(L)(e.price)),1),b(ye,{flag:e.price_anomaly},null,8,["flag"])]),i("p",st,r(e.city),1),i("p",at,r(e.surface)+"mÂ² - "+r(o(M)(e.price_m2,0))+"â‚¬/mÂ²",1),i("p",it,r(o(D)(e.title,50)),1)],8,et))),128))]),i("button",{onClick:e=>p.value.delete(t),class:"btn btn-secondary text-sm mt-3 w-full"}," RÃ©duire ",8,nt)])):c("",!0)],4))),128)),0===y.value?(s(),a("div",rt,[...t[0]||(t[0]=[i("i",{class:"fas fa-inbox text-2xl mb-2"},null,-1),i("p",null,"Aucune annonce ne correspond Ã  vos filtres",-1)])])):c("",!0)]))}},ct={},dt={class:"card p-0 overflow-hidden"},ut={key:0,class:"h-96 flex items-center justify-center bg-gray-100"},gt={key:1,id:"map",style:{height:"500px",width:"100%"}},mt={class:"p-4 border-t border-gray-200"},pt={class:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm"},ft={class:"text-xs text-gray-600 mt-3"},bt=j({__name:"MapView",setup(e){const l=_(),c=S(),d=t(!1),u=async()=>{const e=(await function(e,t){let l=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));l=Promise.allSettled(t.map(e=>{if((e=function(e){return"/immo-bot-luxembourg/dashboards2/"+e}(e))in ct)return;ct[e]=!0;const t=e.endsWith(".css"),l=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${l}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise((t,l)=>{a.addEventListener("load",t),a.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return l.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})}(async()=>{const{default:e}=await import("./leaflet-BKWJAMSo.js").then(e=>e.l);return{default:e}},[])).default,t=l.appliedFilters.filter(e=>e.latitude&&e.longitude);if(0===t.length)return void alert("Aucune annonce avec coordonnÃ©es GPS");const s=e.map("map").setView([49.6116,6.1319],9);if(e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Â© OpenStreetMap contributors",maxZoom:19}).addTo(s),t.forEach(t=>{e.circleMarker([t.latitude,t.longitude],{radius:8,fillColor:c.getSiteColor(t.site),color:"#fff",weight:2,opacity:1,fillOpacity:.7}).addTo(s).bindPopup(`\n      <div style="min-width: 200px;">\n        <strong>${t.city}</strong><br>\n        <span style="color: #4F46E5; font-weight: bold;">â‚¬${t.price.toLocaleString("fr-LU")}</span><br>\n        ${t.surface}mÂ² - ${t.rooms||"â€”"} piÃ¨ces<br>\n        <small>${t.site}</small><br>\n        <a href="${t.url}" target="_blank" style="color: #3B82F6; text-decoration: underline;">\n          Voir annonce\n        </a>\n      </div>\n    `)}),t.length>0){const l=e.latLngBounds(t.map(e=>[e.latitude,e.longitude]));s.fitBounds(l,{padding:[50,50]})}d.value=!0};return(e,t)=>(s(),a("div",dt,[d.value?(s(),a("div",gt)):(s(),a("div",ut,[i("button",{onClick:u,class:"btn btn-primary"},[...t[0]||(t[0]=[i("i",{class:"fas fa-map"},null,-1),n(" Charger la carte ",-1)])])])),i("div",mt,[t[2]||(t[2]=i("h3",{class:"font-semibold mb-3"},"LÃ©gende des sites",-1)),i("div",pt,[(s(!0),a(g,null,m(o(l).uniqueSites,e=>(s(),a("div",{key:e,class:"flex items-center gap-2"},[i("span",{class:"inline-block w-3 h-3 rounded-full",style:f({backgroundColor:o(c).getSiteColor(e)})},null,4),i("span",null,r(e.split(".")[0]),1)]))),128))]),i("p",ft,[t[1]||(t[1]=i("i",{class:"fas fa-info-circle"},null,-1)),n(" "+r(o(l).appliedFilters.length)+" annonce(s) avec coordonnÃ©es GPS ",1)])])]))}},[["__scopeId","data-v-865a00a5"]]),vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},xt=["href"],yt={class:"flex justify-between items-start mb-2"},ht={class:"badge bg-gray-200 text-gray-800 text-xs"},kt={class:"font-bold text-gray-800 mb-2"},wt={class:"flex items-baseline gap-2 mb-3"},_t={class:"text-2xl font-bold text-primary"},St={class:"text-sm text-gray-600"},Ct={class:"grid grid-cols-3 gap-2 text-sm text-gray-600 mb-3 pb-3 border-b border-gray-200"},At={class:"flex justify-between items-center"},Ft={key:0,class:"card text-center py-12 text-gray-500"},Pt={__name:"NewListingsPage",setup(e){const t=_(),d=S(),u=l(()=>t.appliedFilters.sort((e,t)=>new Date(t.published_at)-new Date(e.published_at)).slice(0,12));return(e,t)=>(s(),a("div",null,[t[5]||(t[5]=i("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"âœ¨ Annonces RÃ©centes",-1)),i("div",vt,[(s(!0),a(g,null,m(u.value,e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"card hover:shadow-lg transition-shadow overflow-hidden"},[i("div",yt,[i("span",{class:"site-badge text-xs",style:f({backgroundColor:o(d).getSiteColor(e.site)})},r(e.site.split(".")[0]),5),i("span",ht,r(e.time_ago),1)]),i("h3",kt,r(o(D)(e.title,60)),1),i("div",wt,[i("span",_t,r(o(L)(e.price)),1),i("span",St,r(o(M)(e.price_m2,0))+"â‚¬/mÂ²",1)]),i("div",Ct,[i("div",null,[t[0]||(t[0]=i("i",{class:"fas fa-map-pin text-primary"},null,-1)),i("p",null,r(e.city),1)]),i("div",null,[t[1]||(t[1]=i("i",{class:"fas fa-door-open text-primary"},null,-1)),i("p",null,r(e.rooms||"â€”")+" piÃ¨ces",1)]),i("div",null,[t[2]||(t[2]=i("i",{class:"fas fa-ruler-combined text-primary"},null,-1)),i("p",null,r(e.surface)+"mÂ²",1)])]),i("div",At,[b(ye,{flag:e.price_anomaly},null,8,["flag"]),t[3]||(t[3]=i("button",{class:"btn btn-primary text-xs py-1 px-2"},[n(" Voir "),i("i",{class:"fas fa-arrow-right"})],-1))])],8,xt))),128))]),0===u.value.length?(s(),a("div",Ft,[...t[4]||(t[4]=[i("i",{class:"fas fa-inbox text-3xl mb-2"},null,-1),i("p",null,"Aucune annonce rÃ©cente",-1)])])):c("",!0)]))}},Et={class:"space-y-6"},Lt={class:"text-2xl font-bold text-danger mb-4"},Mt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Dt=["href"],jt={class:"flex justify-between items-start mb-2"},Ot={class:"badge bg-danger text-white"},Rt={class:"font-bold text-gray-800 mb-2"},Vt={class:"grid grid-cols-2 gap-2 text-sm mb-3"},It={class:"font-bold text-primary"},Tt={class:"font-bold"},qt={class:"text-xs text-gray-600"},Nt={key:0,class:"card text-center py-8 text-gray-500"},Bt={class:"text-2xl font-bold text-success mb-4"},Ut={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},$t=["href"],Gt={class:"flex justify-between items-start mb-2"},Ht={class:"badge bg-success text-white"},zt={class:"font-bold text-gray-800 mb-2"},Jt={class:"grid grid-cols-2 gap-2 text-sm mb-3"},Kt={class:"font-bold text-primary"},Wt={class:"font-bold"},Zt={class:"text-xs text-gray-600"},Qt={key:0,class:"card text-center py-8 text-gray-500"},Xt=j({__name:"AnomaliesPage",setup(e){const t=_(),n=S(),d=l(()=>t.appliedFilters.filter(e=>"HIGH"===e.price_anomaly)),u=l(()=>t.appliedFilters.filter(e=>"GOOD_DEAL"===e.price_anomaly)),p=e=>{const l=t.allListings.filter(t=>t.city===e);if(0===l.length)return 0;const s=l.map(e=>e.price).sort((e,t)=>e-t),a=Math.floor(s.length/2);return s.length%2!=0?s[a]:(s[a-1]+s[a])/2};return(e,t)=>(s(),a("div",Et,[i("div",null,[i("h2",Lt," ðŸš¨ Annonces ChÃ¨res ("+r(d.value.length)+") ",1),t[3]||(t[3]=i("p",{class:"text-sm text-gray-600 mb-4"}," Ces annonces coÃ»tent plus de 2.5x la mÃ©diane pour leur ville ",-1)),i("div",Mt,[(s(!0),a(g,null,m(d.value,e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"card border-l-4 border-danger hover:shadow-lg transition-shadow"},[i("div",jt,[i("span",{class:"site-badge text-xs",style:f({backgroundColor:o(n).getSiteColor(e.site)})},r(e.site.split(".")[0]),5),i("span",Ot,r(Math.round(e.price/p(e.city)*100))+"%",1)]),i("h3",Rt,r(o(D)(e.title,50)),1),i("div",Vt,[i("div",null,[t[0]||(t[0]=i("span",{class:"text-gray-600"},"Prix:",-1)),i("p",It,r(o(L)(e.price)),1)]),i("div",null,[t[1]||(t[1]=i("span",{class:"text-gray-600"},"MÃ©diane:",-1)),i("p",Tt,r(o(L)(p(e.city))),1)])]),i("p",qt,r(e.city)+" â€¢ "+r(e.surface)+"mÂ²",1)],8,Dt))),128))]),0===d.value.length?(s(),a("div",Nt,[...t[2]||(t[2]=[i("p",null,"Aucune annonce chÃ¨re ðŸ‘",-1)])])):c("",!0)]),i("div",null,[i("h2",Bt," ðŸŽ‰ Bonnes Affaires ("+r(u.value.length)+") ",1),t[7]||(t[7]=i("p",{class:"text-sm text-gray-600 mb-4"}," Ces annonces coÃ»tent moins de 0.7x la mÃ©diane pour leur ville ",-1)),i("div",Ut,[(s(!0),a(g,null,m(u.value,e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"card border-l-4 border-success hover:shadow-lg transition-shadow"},[i("div",Gt,[i("span",{class:"site-badge text-xs",style:f({backgroundColor:o(n).getSiteColor(e.site)})},r(e.site.split(".")[0]),5),i("span",Ht,r(Math.round(e.price/p(e.city)*100))+"%",1)]),i("h3",zt,r(o(D)(e.title,50)),1),i("div",Jt,[i("div",null,[t[4]||(t[4]=i("span",{class:"text-gray-600"},"Prix:",-1)),i("p",Kt,r(o(L)(e.price)),1)]),i("div",null,[t[5]||(t[5]=i("span",{class:"text-gray-600"},"MÃ©diane:",-1)),i("p",Wt,r(o(L)(p(e.city))),1)])]),i("p",Zt,r(e.city)+" â€¢ "+r(e.surface)+"mÂ²",1)],8,$t))),128))]),0===u.value.length?(s(),a("div",Qt,[...t[6]||(t[6]=[i("p",null,"Aucune bonne affaire pour le moment",-1)])])):c("",!0)])]))}},[["__scopeId","data-v-40f55d23"]]),Yt={class:"space-y-6"},el={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},tl={class:"card"},ll={class:"stat-value"},sl={class:"card"},al={class:"stat-value"},il={class:"card"},nl={class:"stat-value"},rl={class:"card"},ol={class:"stat-value"},cl={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},dl={class:"card"},ul={class:"stat-value"},gl={class:"card"},ml={class:"stat-value"},pl={class:"card"},fl={class:"stat-value"},bl={class:"card"},vl={class:"space-y-2"},xl={class:"flex-1"},yl={class:"font-bold"},hl={class:"w-32 bg-gray-200 rounded-full h-2"},kl={class:"card"},wl={class:"overflow-x-auto"},_l={class:"w-full text-sm"},Sl={class:"font-medium"},Cl={class:"text-right"},Al={class:"text-right"},Fl={class:"text-right font-bold"},Pl={class:"text-right text-xs text-gray-600"},El={class:"text-right"},Ll={__name:"StatsPage",setup(e){const t=_(),l=S(),n=e=>t.allListings.filter(t=>t.site===e).length;return(e,c)=>(s(),a("div",Yt,[i("div",el,[i("div",tl,[i("div",ll,r(o(l).globalStats.total||0),1),c[0]||(c[0]=i("div",{class:"stat-label"},"Annonces Total",-1))]),i("div",sl,[i("div",al,r(o(L)(o(l).globalStats.avg_price)),1),c[1]||(c[1]=i("div",{class:"stat-label"},"Prix Moyen",-1))]),i("div",il,[i("div",nl,r(o(L)(o(l).globalStats.min_price)),1),c[2]||(c[2]=i("div",{class:"stat-label"},"Prix Min",-1))]),i("div",rl,[i("div",ol,r(o(L)(o(l).globalStats.max_price)),1),c[3]||(c[3]=i("div",{class:"stat-label"},"Prix Max",-1))])]),i("div",cl,[i("div",dl,[i("div",ul,r(o(l).globalStats.avg_surface||0)+"mÂ²",1),c[4]||(c[4]=i("div",{class:"stat-label"},"Surface Moyenne",-1))]),i("div",gl,[i("div",ml,r(o(t).uniqueCities.length),1),c[5]||(c[5]=i("div",{class:"stat-label"},"Villes",-1))]),i("div",pl,[i("div",fl,r(o(t).uniqueSites.length),1),c[6]||(c[6]=i("div",{class:"stat-label"},"Sites Source",-1))])]),i("div",bl,[c[7]||(c[7]=i("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Distribution par Site",-1)),i("div",vl,[(s(!0),a(g,null,m(o(t).uniqueSites,e=>(s(),a("div",{key:e,class:"flex items-center gap-3"},[i("span",{class:"inline-block w-3 h-3 rounded-full",style:f({backgroundColor:o(l).getSiteColor(e)})},null,4),i("span",xl,r(e),1),i("span",yl,r(n(e)),1),i("div",hl,[i("div",{class:"h-2 rounded-full",style:f({width:n(e)/(o(l).globalStats.total||1)*100+"%",backgroundColor:o(l).getSiteColor(e)})},null,4)])]))),128))])]),i("div",kl,[c[9]||(c[9]=i("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Top 10 Villes",-1)),i("div",wl,[i("table",_l,[c[8]||(c[8]=i("thead",{class:"table-header"},[i("tr",null,[i("th",{class:"text-left"},"Ville"),i("th",{class:"text-right"},"Annonces"),i("th",{class:"text-right"},"Prix moy"),i("th",{class:"text-right"},"MÃ©diane"),i("th",{class:"text-right"},"Min - Max"),i("th",{class:"text-right"},"Surface moy")])],-1)),i("tbody",null,[(s(!0),a(g,null,m(o(l).topCities.slice(0,10),e=>(s(),a("tr",{key:e.city},[i("td",Sl,r(e.city),1),i("td",Cl,r(e.count),1),i("td",Al,r(o(L)(e.avg_price)),1),i("td",Fl,r(o(L)(e.median_price)),1),i("td",Pl,r(o(L)(e.min_price))+" - "+r(o(L)(e.max_price)),1),i("td",El,r(e.avg_surface)+"mÂ²",1)]))),128))])])])])]))}},Ml={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Dl=["href"],jl={class:"p-3"},Ol={class:"font-medium text-sm text-gray-800"},Rl={class:"text-lg font-bold text-primary"},Vl={class:"text-xs text-gray-600"},Il={key:0,class:"card text-center py-12 text-gray-500"},Tl={__name:"PhotosPage",setup(e){const t=_(),n=l(()=>t.appliedFilters.slice(0,20));return(e,t)=>(s(),a("div",null,[t[2]||(t[2]=i("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"ðŸ–¼ï¸ Galerie Photos",-1)),i("div",Ml,[(s(!0),a(g,null,m(n.value,e=>(s(),a("a",{key:e.listing_id,href:e.url,target:"_blank",class:"card p-0 overflow-hidden hover:shadow-lg transition-shadow"},[t[0]||(t[0]=i("div",{class:"bg-gray-300 h-40 flex items-center justify-center"},[i("i",{class:"fas fa-image text-gray-400 text-4xl"})],-1)),i("div",jl,[i("p",Ol,r(e.city),1),i("p",Rl,r(o(L)(e.price)),1),i("p",Vl,r(e.surface)+"mÂ² â€¢ "+r(e.rooms||"â€”")+" piÃ¨ces",1)])],8,Dl))),128))]),0===n.value.length?(s(),a("div",Il,[...t[1]||(t[1]=[i("i",{class:"fas fa-inbox text-3xl mb-2"},null,-1),i("p",null,"Aucune photo disponible",-1),i("small",{class:"mt-2 block"},"Les photos des annonces seront bientÃ´t intÃ©grÃ©es",-1)])])):c("",!0)]))}},ql={class:"flex flex-wrap gap-2 mb-6 border-b border-gray-200 overflow-x-auto"},Nl=["onClick"],Bl={key:0,class:"ml-2 badge bg-primary text-white"},Ul={class:"animate-fade-in"},$l=j({__name:"Tabs",setup(e){const o=t(0),d=_(),u=S(),p=l(()=>[{label:"Tableau",icon:"ðŸ“Š",badge:d.appliedFilters.length},{label:"Par Ville",icon:"ðŸ™ï¸",badge:d.uniqueCities.length},{label:"Par Prix",icon:"ðŸ’°",badge:null},{label:"Carte",icon:"ðŸ—ºï¸",badge:null},{label:"NouveautÃ©s",icon:"âœ¨",badge:null},{label:"Anomalies",icon:"ðŸš¨",badge:u.highAnomaliesCount+u.goodDealsCount},{label:"Stats",icon:"ðŸ“ˆ",badge:null},{label:"Photos",icon:"ðŸ–¼ï¸",badge:null}]);return(e,t)=>(s(),a("div",null,[i("div",ql,[(s(!0),a(g,null,m(p.value,(e,t)=>(s(),a("button",{key:t,onClick:e=>o.value=t,class:y(["px-4 py-3 font-medium text-sm whitespace-nowrap border-b-2 transition-colors",o.value===t?"border-primary text-primary":"border-transparent text-gray-600 hover:text-gray-800"])},[n(r(e.icon)+" "+r(e.label)+" ",1),e.badge?(s(),a("span",Bl,r(e.badge),1)):c("",!0)],10,Nl))),128))]),i("div",Ul,[0===o.value?(s(),x(Fe,{key:0})):1===o.value?(s(),x(Be,{key:1})):2===o.value?(s(),x(ot,{key:2})):3===o.value?(s(),x(bt,{key:3})):4===o.value?(s(),x(Pt,{key:4})):5===o.value?(s(),x(Xt,{key:5})):6===o.value?(s(),x(Ll,{key:6})):7===o.value?(s(),x(Tl,{key:7})):c("",!0)])]))}},[["__scopeId","data-v-caedcadd"]]),Gl={class:"min-h-screen bg-gray-50"},Hl={class:"container mx-auto px-4 py-6"},zl={key:0,class:"text-center py-12"},Jl=k({__name:"App",setup(e){const l=t(!0),n=_(),r=S();return h(async()=>{try{await async function(e,t){try{const[l,s,a,i]=await Promise.all([A(),F(),P(),E()]);return e.loadListings(l),t.loadStats(s),t.loadAnomalies(a),t.loadMarketStats(i),{listings:l,statsData:s,anomalies:a,marketStats:i}}catch(l){throw l}}(n,r)}catch(e){}finally{l.value=!1}}),(e,t)=>(s(),a("div",Gl,[l.value?c("",!0):(s(),x(Q,{key:0})),i("main",Hl,[l.value?(s(),a("div",zl,[...t[0]||(t[0]=[i("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1),i("p",{class:"mt-4 text-gray-600"},"Chargement des donnÃ©es...",-1)])])):(s(),a(g,{key:1},[b(fe),b($l)],64))])]))}});Jl.use(w()),Jl.mount("#app");
